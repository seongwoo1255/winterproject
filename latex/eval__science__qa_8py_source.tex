\doxysection{eval\+\_\+science\+\_\+qa.\+py}
\hypertarget{eval__science__qa_8py_source}{}\label{eval__science__qa_8py_source}\index{llava/eval/eval\_science\_qa.py@{llava/eval/eval\_science\_qa.py}}
\mbox{\hyperlink{eval__science__qa_8py}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00001}\mbox{\hyperlink{namespaceeval__science__qa}{00001}}\ \textcolor{keyword}{import}\ argparse}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00002}00002\ \textcolor{keyword}{import}\ json}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00003}00003\ \textcolor{keyword}{import}\ os}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00004}00004\ \textcolor{keyword}{import}\ re}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00005}00005\ \textcolor{keyword}{import}\ random}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00008}\mbox{\hyperlink{namespaceeval__science__qa_a338f040d97805ab7d17760cbed0c877c}{00008}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespaceeval__science__qa_a338f040d97805ab7d17760cbed0c877c}{get\_args}}():}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00009}00009\ \ \ \ \ parser\ =\ argparse.ArgumentParser()}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00010}00010\ \ \ \ \ parser.add\_argument(\textcolor{stringliteral}{'-\/-\/base-\/dir'},\ type=str)}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00011}00011\ \ \ \ \ parser.add\_argument(\textcolor{stringliteral}{'-\/-\/result-\/file'},\ type=str)}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00012}00012\ \ \ \ \ parser.add\_argument(\textcolor{stringliteral}{'-\/-\/output-\/file'},\ type=str)}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00013}00013\ \ \ \ \ parser.add\_argument(\textcolor{stringliteral}{'-\/-\/output-\/result'},\ type=str)}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00014}00014\ \ \ \ \ parser.add\_argument(\textcolor{stringliteral}{'-\/-\/split'},\ type=str,\ default=\textcolor{stringliteral}{'test'})}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00015}00015\ \ \ \ \ parser.add\_argument(\textcolor{stringliteral}{'-\/-\/options'},\ type=list,\ default=[\textcolor{stringliteral}{"{}A"{}},\ \textcolor{stringliteral}{"{}B"{}},\ \textcolor{stringliteral}{"{}C"{}},\ \textcolor{stringliteral}{"{}D"{}},\ \textcolor{stringliteral}{"{}E"{}}])}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00016}00016\ \ \ \ \ \textcolor{keywordflow}{return}\ parser.parse\_args()}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00018}00018\ }
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00019}\mbox{\hyperlink{namespaceeval__science__qa_a18f9d9e163ec1f01332ed0481b634883}{00019}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespaceeval__science__qa_a18f9d9e163ec1f01332ed0481b634883}{convert\_caps}}(results):}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00020}00020\ \ \ \ \ fakecaps\ =\ []}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00021}00021\ \ \ \ \ \textcolor{keywordflow}{for}\ result\ \textcolor{keywordflow}{in}\ results:}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00022}00022\ \ \ \ \ \ \ \ \ image\_id\ =\ result[\textcolor{stringliteral}{'question\_id'}]}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00023}00023\ \ \ \ \ \ \ \ \ caption\ =\ result[\textcolor{stringliteral}{'text'}]}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00024}00024\ \ \ \ \ \ \ \ \ fakecaps.append(\{\textcolor{stringliteral}{"{}image\_id"{}}:\ int(image\_id),\ \textcolor{stringliteral}{"{}caption"{}}:\ caption\})}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00025}00025\ \ \ \ \ \textcolor{keywordflow}{return}\ fakecaps}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00026}00026\ }
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00027}00027\ }
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00028}\mbox{\hyperlink{namespaceeval__science__qa_ad595084a870f1872e06b1b81e553d56e}{00028}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespaceeval__science__qa_ad595084a870f1872e06b1b81e553d56e}{get\_pred\_idx}}(prediction,\ choices,\ options):}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00029}00029\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00030}00030\ \textcolor{stringliteral}{\ \ \ \ Get\ the\ index\ (e.g.\ 2)\ from\ the\ prediction\ (e.g.\ 'C')}}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00031}00031\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00032}00032\ \ \ \ \ \textcolor{keywordflow}{if}\ prediction\ \textcolor{keywordflow}{in}\ options[:len(choices)]:}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00033}00033\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ options.index(prediction)}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00034}00034\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00035}00035\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00036}00036\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ random.choice(range(len(choices)))}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00037}00037\ }
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00038}00038\ }
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00039}00039\ \textcolor{keywordflow}{if}\ \_\_name\_\_\ ==\ \textcolor{stringliteral}{"{}\_\_main\_\_"{}}:}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00040}\mbox{\hyperlink{namespaceeval__science__qa_a98606b88fa74df5cc8cbdf148532eed1}{00040}}\ \ \ \ \ args\ =\ \mbox{\hyperlink{namespaceeval__science__qa_a338f040d97805ab7d17760cbed0c877c}{get\_args}}()}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00041}00041\ }
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00042}\mbox{\hyperlink{namespaceeval__science__qa_aa6d19df3b263d5d12c6dd5076f382dc9}{00042}}\ \ \ \ \ base\_dir\ =\ args.base\_dir}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00043}\mbox{\hyperlink{namespaceeval__science__qa_af6b62d0625f35421a91c5008ee7c258e}{00043}}\ \ \ \ \ split\_indices\ =\ json.load(open(os.path.join(base\_dir,\ \textcolor{stringliteral}{"{}pid\_splits.json"{}})))[args.split]}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00044}\mbox{\hyperlink{namespaceeval__science__qa_aed3634b320b248a2040aeb7536f40174}{00044}}\ \ \ \ \ problems\ =\ json.load(open(os.path.join(base\_dir,\ \textcolor{stringliteral}{"{}problems.json"{}})))}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00045}\mbox{\hyperlink{namespaceeval__science__qa_ab686ebb9cb66d916a6bba8e180e18248}{00045}}\ \ \ \ \ predictions\ =\ [json.loads(line)\ \textcolor{keywordflow}{for}\ line\ \textcolor{keywordflow}{in}\ open(args.result\_file)]}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00046}00046\ \ \ \ \ predictions\ =\ \{pred[\textcolor{stringliteral}{'question\_id'}]:\ pred\ \textcolor{keywordflow}{for}\ pred\ \textcolor{keywordflow}{in}\ predictions\}}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00047}\mbox{\hyperlink{namespaceeval__science__qa_aa0328d2fe84c654dba7c9e50109295e9}{00047}}\ \ \ \ \ split\_problems\ =\ \{idx:\ problems[idx]\ \textcolor{keywordflow}{for}\ idx\ \textcolor{keywordflow}{in}\ split\_indices\}}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00048}00048\ }
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00049}\mbox{\hyperlink{namespaceeval__science__qa_af6912d3bb0b74f630b39d587f02348a1}{00049}}\ \ \ \ \ results\ =\ \{\textcolor{stringliteral}{'correct'}:\ [],\ \textcolor{stringliteral}{'incorrect'}:\ []\}}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00050}\mbox{\hyperlink{namespaceeval__science__qa_affa5cc0c383b188cb083990cbb2172f8}{00050}}\ \ \ \ \ sqa\_results\ =\ \{\}}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00051}00051\ \ \ \ \ sqa\_results[\textcolor{stringliteral}{'acc'}]\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00052}00052\ \ \ \ \ sqa\_results[\textcolor{stringliteral}{'correct'}]\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00053}00053\ \ \ \ \ sqa\_results[\textcolor{stringliteral}{'count'}]\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00054}00054\ \ \ \ \ sqa\_results[\textcolor{stringliteral}{'results'}]\ =\ \{\}}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00055}00055\ \ \ \ \ sqa\_results[\textcolor{stringliteral}{'outputs'}]\ =\ \{\}}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00056}00056\ }
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00057}00057\ \ \ \ \ \textcolor{keywordflow}{for}\ prob\_id,\ prob\ \textcolor{keywordflow}{in}\ split\_problems.items():}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00058}00058\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ prob\_id\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ predictions:}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00059}\mbox{\hyperlink{namespaceeval__science__qa_a1281b2085d0d414c918126dfe4806466}{00059}}\ \ \ \ \ \ \ \ \ \ \ \ \ pred\ =\ \{\textcolor{stringliteral}{'text'}:\ \textcolor{stringliteral}{'FAILED'},\ \textcolor{stringliteral}{'prompt'}:\ \textcolor{stringliteral}{'Unknown'}\}}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00060}\mbox{\hyperlink{namespaceeval__science__qa_a9c8c299e5e79d3d82809778750123b9e}{00060}}\ \ \ \ \ \ \ \ \ \ \ \ \ pred\_text\ =\ \textcolor{stringliteral}{'FAILED'}}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00061}00061\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00062}00062\ \ \ \ \ \ \ \ \ \ \ \ \ pred\ =\ predictions[prob\_id]}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00063}00063\ \ \ \ \ \ \ \ \ \ \ \ \ pred\_text\ =\ pred[\textcolor{stringliteral}{'text'}]}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00064}00064\ }
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00065}00065\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ pred\_text\ \textcolor{keywordflow}{in}\ args.options:}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00066}\mbox{\hyperlink{namespaceeval__science__qa_a8cc4b4c3dd1e8eb61f098ae68bea954e}{00066}}\ \ \ \ \ \ \ \ \ \ \ \ \ answer\ =\ pred\_text}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ len(pred\_text)\ >=\ 3\ \textcolor{keywordflow}{and}\ pred\_text[0]\ \textcolor{keywordflow}{in}\ args.options\ \textcolor{keywordflow}{and}\ pred\_text[1:3]\ ==\ \textcolor{stringliteral}{"{}.\ "{}}:}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00068}00068\ \ \ \ \ \ \ \ \ \ \ \ \ answer\ =\ pred\_text[0]}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00069}00069\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00070}\mbox{\hyperlink{namespaceeval__science__qa_a2ed4f6e7aa7f866672cab13bfa148366}{00070}}\ \ \ \ \ \ \ \ \ \ \ \ \ pattern\ =\ re.compile(\textcolor{stringliteral}{r'The\ answer\ is\ ([A-\/Z]).'})}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00071}\mbox{\hyperlink{namespaceeval__science__qa_a668b66a8f11caf3a8d69c6a201b739cf}{00071}}\ \ \ \ \ \ \ \ \ \ \ \ \ res\ =\ pattern.findall(pred\_text)}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00072}00072\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ len(res)\ ==\ 1:}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00073}00073\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ answer\ =\ res[0]\ \ \textcolor{comment}{\#\ 'A',\ 'B',\ ...}}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00074}00074\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00075}00075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ answer\ =\ \textcolor{stringliteral}{"{}FAILED"{}}}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00076}00076\ }
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00077}\mbox{\hyperlink{namespaceeval__science__qa_adf9c1ad133dd1c7206b29dc4fbeb988d}{00077}}\ \ \ \ \ \ \ \ \ pred\_idx\ =\ \mbox{\hyperlink{namespaceeval__science__qa_ad595084a870f1872e06b1b81e553d56e}{get\_pred\_idx}}(answer,\ prob[\textcolor{stringliteral}{'choices'}],\ args.options)}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00078}00078\ }
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00079}\mbox{\hyperlink{namespaceeval__science__qa_a3e1663e78375d7b17c8ae47598334470}{00079}}\ \ \ \ \ \ \ \ \ analysis\ =\ \{}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00080}00080\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'question\_id'}:\ prob\_id,}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00081}00081\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'parsed\_ans'}:\ answer,}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00082}00082\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'ground\_truth'}:\ args.options[prob[\textcolor{stringliteral}{'answer'}]],}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00083}00083\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'question'}:\ pred[\textcolor{stringliteral}{'prompt'}],}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00084}00084\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'pred'}:\ pred\_text,}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00085}00085\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'is\_multimodal'}:\ \textcolor{stringliteral}{'<image>'}\ \textcolor{keywordflow}{in}\ pred[\textcolor{stringliteral}{'prompt'}],}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00086}00086\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00087}00087\ }
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00088}00088\ \ \ \ \ \ \ \ \ sqa\_results[\textcolor{stringliteral}{'results'}][prob\_id]\ =\ \mbox{\hyperlink{namespaceeval__science__qa_ad595084a870f1872e06b1b81e553d56e}{get\_pred\_idx}}(answer,\ prob[\textcolor{stringliteral}{'choices'}],\ args.options)}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00089}00089\ \ \ \ \ \ \ \ \ sqa\_results[\textcolor{stringliteral}{'outputs'}][prob\_id]\ =\ pred\_text}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00090}00090\ }
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00091}00091\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ pred\_idx\ ==\ prob[\textcolor{stringliteral}{'answer'}]:}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00092}00092\ \ \ \ \ \ \ \ \ \ \ \ \ results[\textcolor{stringliteral}{'correct'}].append(analysis)}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00093}00093\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00094}00094\ \ \ \ \ \ \ \ \ \ \ \ \ results[\textcolor{stringliteral}{'incorrect'}].append(analysis)}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00095}00095\ }
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00096}\mbox{\hyperlink{namespaceeval__science__qa_af983ad080b7c972d6bd0d619c38a1811}{00096}}\ \ \ \ \ correct\ =\ len(results[\textcolor{stringliteral}{'correct'}])}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00097}\mbox{\hyperlink{namespaceeval__science__qa_a5b5ba9b229edcfaa4b33f77b64950e90}{00097}}\ \ \ \ \ total\ =\ len(results[\textcolor{stringliteral}{'correct'}])\ +\ len(results[\textcolor{stringliteral}{'incorrect'}])}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00098}00098\ }
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00099}00099\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00100}\mbox{\hyperlink{namespaceeval__science__qa_a85a84518d967b565d957717855aff3ad}{00100}}\ \ \ \ \ multimodal\_correct\ =\ len([x\ \textcolor{keywordflow}{for}\ x\ \textcolor{keywordflow}{in}\ results[\textcolor{stringliteral}{'correct'}]\ \textcolor{keywordflow}{if}\ x[\textcolor{stringliteral}{'is\_multimodal'}]])}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00101}\mbox{\hyperlink{namespaceeval__science__qa_a7bb59d4da31b98c0c6c67365221b58d6}{00101}}\ \ \ \ \ multimodal\_incorrect\ =\ len([x\ \textcolor{keywordflow}{for}\ x\ \textcolor{keywordflow}{in}\ results[\textcolor{stringliteral}{'incorrect'}]\ \textcolor{keywordflow}{if}\ x[\textcolor{stringliteral}{'is\_multimodal'}]])}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00102}\mbox{\hyperlink{namespaceeval__science__qa_a8e2e10abbc802e76b3b49430ec73aeca}{00102}}\ \ \ \ \ multimodal\_total\ =\ multimodal\_correct\ +\ multimodal\_incorrect}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00103}00103\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00104}00104\ }
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00105}00105\ \ \ \ \ print(f\textcolor{stringliteral}{'Total:\ \{total\},\ Correct:\ \{correct\},\ Accuracy:\ \{correct\ /\ total\ *\ 100:.2f\}\%,\ IMG-\/Accuracy:\ \{multimodal\_correct\ /\ multimodal\_total\ *\ 100:.2f\}\%'})}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00106}00106\ }
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00107}00107\ \ \ \ \ sqa\_results[\textcolor{stringliteral}{'acc'}]\ =\ correct\ /\ total\ *\ 100}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00108}00108\ \ \ \ \ sqa\_results[\textcolor{stringliteral}{'correct'}]\ =\ correct}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00109}00109\ \ \ \ \ sqa\_results[\textcolor{stringliteral}{'count'}]\ =\ total}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00110}00110\ }
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00111}00111\ \ \ \ \ \textcolor{keyword}{with}\ open(args.output\_file,\ \textcolor{stringliteral}{'w'})\ \textcolor{keyword}{as}\ f:}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00112}\mbox{\hyperlink{namespaceeval__science__qa_af735416e59b405b1155de5e40e093efb}{00112}}\ \ \ \ \ \ \ \ \ json.dump(results,\ f,\ indent=2)}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00113}00113\ \ \ \ \ \textcolor{keyword}{with}\ open(args.output\_result,\ \textcolor{stringliteral}{'w'})\ \textcolor{keyword}{as}\ f:}
\DoxyCodeLine{\Hypertarget{eval__science__qa_8py_source_l00114}00114\ \ \ \ \ \ \ \ \ json.dump(sqa\_results,\ f,\ indent=2)}

\end{DoxyCode}
