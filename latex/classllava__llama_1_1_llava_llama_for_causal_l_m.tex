\doxysection{llava\+\_\+llama.\+Llava\+Llama\+For\+Causal\+LM Class Reference}
\hypertarget{classllava__llama_1_1_llava_llama_for_causal_l_m}{}\label{classllava__llama_1_1_llava_llama_for_causal_l_m}\index{llava\_llama.LlavaLlamaForCausalLM@{llava\_llama.LlavaLlamaForCausalLM}}


LLa\+VA LLa\+MA 변형을 통한 Causal Language Model 구현  




Inheritance diagram for llava\+\_\+llama.\+Llava\+Llama\+For\+Causal\+LM\+:
% FIG 0


Collaboration diagram for llava\+\_\+llama.\+Llava\+Llama\+For\+Causal\+LM\+:
% FIG 1
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classllava__llama_1_1_llava_llama_for_causal_l_m_a7c6851e43aeb03586de6f6c6c9af7a93}{\+\_\+\+\_\+init\+\_\+\+\_\+}} (self, config)
\item 
\mbox{\hyperlink{classllava__llama_1_1_llava_llama_for_causal_l_m_acb62d2eeebdce0deacfd0f86a86b4413}{get\+\_\+model}} (self)
\begin{DoxyCompactList}\small\item\em 모델 객체를 반환하는 메서드 \end{DoxyCompactList}\item 
Union\mbox{[}Tuple, Causal\+LMOutput\+With\+Past\mbox{]} \mbox{\hyperlink{classllava__llama_1_1_llava_llama_for_causal_l_m_a09af443070a2e3de38aa757937fcfd8a}{forward}} (self, torch.\+Long\+Tensor input\+\_\+ids=None, Optional\mbox{[}torch.\+Tensor\mbox{]} attention\+\_\+mask=None, Optional\mbox{[}torch.\+Long\+Tensor\mbox{]} position\+\_\+ids=None, Optional\mbox{[}List\mbox{[}torch.\+Float\+Tensor\mbox{]}\mbox{]} past\+\_\+key\+\_\+values=None, Optional\mbox{[}torch.\+Float\+Tensor\mbox{]} inputs\+\_\+embeds=None, Optional\mbox{[}torch.\+Long\+Tensor\mbox{]} labels=None, Optional\mbox{[}bool\mbox{]} use\+\_\+cache=None, Optional\mbox{[}bool\mbox{]} output\+\_\+attentions=None, Optional\mbox{[}bool\mbox{]} output\+\_\+hidden\+\_\+states=None, Optional\mbox{[}torch.\+Float\+Tensor\mbox{]} images=None, Optional\mbox{[}List\mbox{[}List\mbox{[}int\mbox{]}\mbox{]}\mbox{]} image\+\_\+sizes=None, Optional\mbox{[}bool\mbox{]} return\+\_\+dict=None)
\begin{DoxyCompactList}\small\item\em 멀티모달 Causal Language Model의 forward 패스를 정의합니다. \end{DoxyCompactList}\item 
Union\mbox{[}Generate\+Output, torch.\+Long\+Tensor\mbox{]} \mbox{\hyperlink{classllava__llama_1_1_llava_llama_for_causal_l_m_af7b777324d57e9dac2f8b5eb65428e60}{generate}} (self, Optional\mbox{[}torch.\+Tensor\mbox{]} inputs=None, Optional\mbox{[}torch.\+Tensor\mbox{]} images=None, Optional\mbox{[}torch.\+Tensor\mbox{]} image\+\_\+sizes=None, \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}kwargs)
\begin{DoxyCompactList}\small\item\em 멀티모달 입력 데이터를 기반으로 텍스트를 생성하는 메서드입니다. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classllava__llama_1_1_llava_llama_for_causal_l_m_a0f5cfb63f7c65b6a7b4a60c8399edbbb}{prepare\+\_\+inputs\+\_\+for\+\_\+generation}} (self, input\+\_\+ids, past\+\_\+key\+\_\+values=None, inputs\+\_\+embeds=None, \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}kwargs)
\begin{DoxyCompactList}\small\item\em 생성에 필요한 입력을 준비하는 메서드 \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classllava__llama_1_1_llava_llama_for_causal_l_m_a5a8752f2f58a4a3a806a69eb2ffaf118}{model}} = \mbox{\hyperlink{classllava__llama_1_1_llava_llama_model}{Llava\+Llama\+Model}}(config)
\item 
\mbox{\hyperlink{classllava__llama_1_1_llava_llama_for_causal_l_m_a401f8203732fb6a2270425993ddc7caa}{pretraining\+\_\+tp}} = config.\+pretraining\+\_\+tp
\item 
\mbox{\hyperlink{classllava__llama_1_1_llava_llama_for_causal_l_m_a83d0e6aa1cdf2893381d825300078370}{vocab\+\_\+size}} = config.\+vocab\+\_\+size
\item 
\mbox{\hyperlink{classllava__llama_1_1_llava_llama_for_causal_l_m_ae9922983d9c91d3f186e759de4d400c1}{lm\+\_\+head}} = nn.\+Linear(config.\+hidden\+\_\+size, config.\+vocab\+\_\+size, bias=False)
\end{DoxyCompactItemize}
\doxysubsubsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classllava__llama_1_1_llava_llama_for_causal_l_m_a5194779b4bddbbcd120b2e7b5273d6db}{config\+\_\+class}} = \mbox{\hyperlink{classllava__llama_1_1_llava_config}{Llava\+Config}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
LLa\+VA LLa\+MA 변형을 통한 Causal Language Model 구현 

\begin{DoxyAuthor}{Author}
이지희(2021113406) 
\end{DoxyAuthor}


Definition at line \mbox{\hyperlink{llava__llama_8py_source_l00057}{57}} of file \mbox{\hyperlink{llava__llama_8py_source}{llava\+\_\+llama.\+py}}.



\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classllava__llama_1_1_llava_llama_for_causal_l_m_a7c6851e43aeb03586de6f6c6c9af7a93}\index{llava\_llama.LlavaLlamaForCausalLM@{llava\_llama.LlavaLlamaForCausalLM}!\_\_init\_\_@{\_\_init\_\_}}
\index{\_\_init\_\_@{\_\_init\_\_}!llava\_llama.LlavaLlamaForCausalLM@{llava\_llama.LlavaLlamaForCausalLM}}
\doxysubsubsection{\texorpdfstring{\_\_init\_\_()}{\_\_init\_\_()}}
{\footnotesize\ttfamily \label{classllava__llama_1_1_llava_llama_for_causal_l_m_a7c6851e43aeb03586de6f6c6c9af7a93} 
llava\+\_\+llama.\+Llava\+Llama\+For\+Causal\+LM.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self}{, }\item[{}]{config}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{llava__llama_8py_source_l00060}{60}} of file \mbox{\hyperlink{llava__llama_8py_source}{llava\+\_\+llama.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ config):}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ super(LlamaForCausalLM,\ self).\_\_init\_\_(config)}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ self.model\ =\ LlavaLlamaModel(config)}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ self.pretraining\_tp\ =\ config.pretraining\_tp}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ self.vocab\_size\ =\ config.vocab\_size}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ self.lm\_head\ =\ nn.Linear(config.hidden\_size,\ config.vocab\_size,\ bias=\textcolor{keyword}{False})}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Initialize\ weights\ and\ apply\ final\ processing}}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ self.post\_init()}
\DoxyCodeLine{00069\ }

\end{DoxyCode}
Here is the call graph for this function\+:
% FIG 2
Here is the caller graph for this function\+:
% FIG 3


\doxysubsection{Member Function Documentation}
\Hypertarget{classllava__llama_1_1_llava_llama_for_causal_l_m_a09af443070a2e3de38aa757937fcfd8a}\index{llava\_llama.LlavaLlamaForCausalLM@{llava\_llama.LlavaLlamaForCausalLM}!forward@{forward}}
\index{forward@{forward}!llava\_llama.LlavaLlamaForCausalLM@{llava\_llama.LlavaLlamaForCausalLM}}
\doxysubsubsection{\texorpdfstring{forward()}{forward()}}
{\footnotesize\ttfamily \label{classllava__llama_1_1_llava_llama_for_causal_l_m_a09af443070a2e3de38aa757937fcfd8a} 
 Union\mbox{[}Tuple, Causal\+LMOutput\+With\+Past\mbox{]} llava\+\_\+llama.\+Llava\+Llama\+For\+Causal\+LM.\+forward (\begin{DoxyParamCaption}\item[{}]{self}{, }\item[{torch.\+Long\+Tensor }]{input\+\_\+ids}{ = {\ttfamily None}, }\item[{Optional\mbox{[}torch.\+Tensor\mbox{]} }]{attention\+\_\+mask}{ = {\ttfamily None}, }\item[{Optional\mbox{[}torch.\+Long\+Tensor\mbox{]} }]{position\+\_\+ids}{ = {\ttfamily None}, }\item[{Optional\mbox{[}List\mbox{[}torch.\+Float\+Tensor\mbox{]}\mbox{]} }]{past\+\_\+key\+\_\+values}{ = {\ttfamily None}, }\item[{Optional\mbox{[}torch.\+Float\+Tensor\mbox{]} }]{inputs\+\_\+embeds}{ = {\ttfamily None}, }\item[{Optional\mbox{[}torch.\+Long\+Tensor\mbox{]} }]{labels}{ = {\ttfamily None}, }\item[{Optional\mbox{[}bool\mbox{]} }]{use\+\_\+cache}{ = {\ttfamily None}, }\item[{Optional\mbox{[}bool\mbox{]} }]{output\+\_\+attentions}{ = {\ttfamily None}, }\item[{Optional\mbox{[}bool\mbox{]} }]{output\+\_\+hidden\+\_\+states}{ = {\ttfamily None}, }\item[{Optional\mbox{[}torch.\+Float\+Tensor\mbox{]} }]{images}{ = {\ttfamily None}, }\item[{Optional\mbox{[}List\mbox{[}List\mbox{[}int\mbox{]}\mbox{]}\mbox{]} }]{image\+\_\+sizes}{ = {\ttfamily None}, }\item[{Optional\mbox{[}bool\mbox{]} }]{return\+\_\+dict}{ = {\ttfamily None}}\end{DoxyParamCaption})}



멀티모달 Causal Language Model의 forward 패스를 정의합니다. 

\begin{DoxyAuthor}{Author}
이지희(2021113406)
\end{DoxyAuthor}
이 메서드는 멀티모달 입력 데이터를 모델에 전달하여 예측 결과를 반환합니다. 텍스트 입력과 이미지 입력을 결합하여 멀티모달 데이터를 처리합니다. 이미지 특징 벡터(Hᵥ)와 텍스트 특징 벡터(Hₓₓ)를 통합한 멀티모달 입력(Hₐ)을 생성하고, 이를 기반으로 Causal Language Model의 출력을 생성합니다.


\begin{DoxyParams}{Parameters}
{\em input\+\_\+ids} & (torch.\+Long\+Tensor) 텍스트 입력 토큰 ID (optional) \\
\hline
{\em attention\+\_\+mask} & (torch.\+Tensor) 입력에 대한 어텐션 마스크 (optional) \\
\hline
{\em position\+\_\+ids} & (torch.\+Long\+Tensor) 입력의 위치 정보 ID. (optional) \\
\hline
{\em past\+\_\+key\+\_\+values} & (List\mbox{[}torch.\+Float\+Tensor\mbox{]}) 이전 키/값 캐시. 디코더에 사용 (optional) \\
\hline
{\em inputs\+\_\+embeds} & (torch.\+Float\+Tensor) 입력 임베딩 (optional) \\
\hline
{\em labels} & (torch.\+Long\+Tensor) 정답 레이블 (optional) \\
\hline
{\em use\+\_\+cache} & (bool) 이전 키/값 캐시를 사용할지 여부 (optional) \\
\hline
{\em output\+\_\+attentions} & (bool) 어텐션 가중치를 출력할지 여부 (optional) \\
\hline
{\em output\+\_\+hidden\+\_\+states} & (bool) 히든 상태를 출력할지 여부 (optional) \\
\hline
{\em images} & (torch.\+Float\+Tensor) 입력 이미지 텐서 (optional) \\
\hline
{\em image\+\_\+sizes} & (List\mbox{[}List\mbox{[}int\mbox{]}\mbox{]}) 입력 이미지 크기 정보 (optional) \\
\hline
{\em return\+\_\+dict} & (bool) 반환 값을 딕셔너리 형식으로 출력할지 여부 (optional)\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\begin{DoxyItemize}
\item Union\mbox{[}Tuple, Causal\+LMOutput\+With\+Past\mbox{]}\+: 모델의 출력. 기본적으로 Causal\+LMOutput\+With\+Past 형식으로 반환됩니다.
\item 텍스트 출력과 필요한 경우 어텐션 정보 및 히든 상태를 포함합니다.
\end{DoxyItemize}
\end{DoxyReturn}

\begin{DoxyExceptions}{Exceptions}
{\em } & \\
\hline
\end{DoxyExceptions}
None. 모든 입력은 optional로 설계되어 있으며, 적절한 처리 과정을 통해 오류를 방지합니다.

\begin{DoxySeeAlso}{See also}
prepare\+\_\+inputs\+\_\+labels\+\_\+for\+\_\+multimodal\+: 멀티모달 입력 데이터를 준비하는 내부 메서드 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{llava__llama_8py_source_l00109}{109}} of file \mbox{\hyperlink{llava__llama_8py_source}{llava\+\_\+llama.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00123\ \ \ \ \ )\ -\/>\ Union[Tuple,\ CausalLMOutputWithPast]:}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ inputs\_embeds\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ (}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ input\_ids,}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ position\_ids,}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ attention\_mask,}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ past\_key\_values,}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ inputs\_embeds,}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ labels}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ )\ =\ self.prepare\_inputs\_labels\_for\_multimodal(}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ input\_ids,}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ position\_ids,}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ attention\_mask,}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ past\_key\_values,}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ labels,}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ images,}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ image\_sizes}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ super().forward(}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ \ \ input\_ids=input\_ids,}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \ \ \ \ attention\_mask=attention\_mask,}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ \ \ position\_ids=position\_ids,}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ past\_key\_values=past\_key\_values,}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \ \ \ \ inputs\_embeds=inputs\_embeds,}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ labels=labels,}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \ \ \ \ use\_cache=use\_cache,}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ output\_attentions=output\_attentions,}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ output\_hidden\_states=output\_hidden\_states,}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \ \ \ \ return\_dict=return\_dict}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00155\ }

\end{DoxyCode}
Here is the call graph for this function\+:
% FIG 4
Here is the caller graph for this function\+:
% FIG 5
\Hypertarget{classllava__llama_1_1_llava_llama_for_causal_l_m_af7b777324d57e9dac2f8b5eb65428e60}\index{llava\_llama.LlavaLlamaForCausalLM@{llava\_llama.LlavaLlamaForCausalLM}!generate@{generate}}
\index{generate@{generate}!llava\_llama.LlavaLlamaForCausalLM@{llava\_llama.LlavaLlamaForCausalLM}}
\doxysubsubsection{\texorpdfstring{generate()}{generate()}}
{\footnotesize\ttfamily \label{classllava__llama_1_1_llava_llama_for_causal_l_m_af7b777324d57e9dac2f8b5eb65428e60} 
 Union\mbox{[}Generate\+Output, torch.\+Long\+Tensor\mbox{]} llava\+\_\+llama.\+Llava\+Llama\+For\+Causal\+LM.\+generate (\begin{DoxyParamCaption}\item[{}]{self}{, }\item[{Optional\mbox{[}torch.\+Tensor\mbox{]} }]{inputs}{ = {\ttfamily None}, }\item[{Optional\mbox{[}torch.\+Tensor\mbox{]} }]{images}{ = {\ttfamily None}, }\item[{Optional\mbox{[}torch.\+Tensor\mbox{]} }]{image\+\_\+sizes}{ = {\ttfamily None}, }\item[{\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{kwargs}{}\end{DoxyParamCaption})}



멀티모달 입력 데이터를 기반으로 텍스트를 생성하는 메서드입니다. 

\begin{DoxyAuthor}{Author}
이지희
\end{DoxyAuthor}
이 메서드는 텍스트와 이미지 입력을 결합하여 텍스트 생성 작업을 수행합니다. LLa\+VA 모델의 언어 생성 기능을 사용하며, 멀티모달 입력이 제공된 경우 적절히 처리하여 최종 응답 텍스트를 반환합니다.


\begin{DoxyParams}{Parameters}
{\em inputs} & (torch.\+Tensor) 입력 텍스트 토큰 (optional) \\
\hline
{\em images} & (torch.\+Tensor) 입력 이미지 데이터 (optional) \\
\hline
{\em image\+\_\+sizes} & (torch.\+Tensor) 이미지 크기 정보 (optional) \\
\hline
{\em \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}kwargs} & 추가 매개변수. 모델의 생성 작업에 필요한 설정 정보를 포함할 수 있습니다\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\begin{DoxyItemize}
\item Union\mbox{[}Generate\+Output, torch.\+Long\+Tensor\mbox{]}\+: 생성된 텍스트 결과
\item 모델에 따라 텍스트 출력과 관련 정보를 포함합니다.
\end{DoxyItemize}
\end{DoxyReturn}

\begin{DoxyExceptions}{Exceptions}
{\em } & \\
\hline
\end{DoxyExceptions}
{\ttfamily Not\+Implemented\+Error}\+: {\ttfamily inputs\+\_\+embeds}가 제공될 경우 발생. 현재 지원되지 않습니다.

\begin{DoxySeeAlso}{See also}
prepare\+\_\+inputs\+\_\+labels\+\_\+for\+\_\+multimodal\+: 멀티모달 입력 데이터를 준비하는 내부 메서드 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{llava__llama_8py_source_l00178}{178}} of file \mbox{\hyperlink{llava__llama_8py_source}{llava\+\_\+llama.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00184\ \ \ \ \ )\ -\/>\ Union[GenerateOutput,\ torch.LongTensor]:}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ position\_ids\ =\ kwargs.pop(\textcolor{stringliteral}{"{}position\_ids"{}},\ \textcolor{keywordtype}{None})}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ attention\_mask\ =\ kwargs.pop(\textcolor{stringliteral}{"{}attention\_mask"{}},\ \textcolor{keywordtype}{None})}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{"{}inputs\_embeds"{}}\ \textcolor{keywordflow}{in}\ kwargs:}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ NotImplementedError(\textcolor{stringliteral}{"{}\`{}inputs\_embeds`\ is\ not\ supported"{}})}
\DoxyCodeLine{00189\ }
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ images\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \ \ \ \ (}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ inputs,}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ position\_ids,}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ attention\_mask,}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_,}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ inputs\_embeds,}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \ \ \ \ )\ =\ self.prepare\_inputs\_labels\_for\_multimodal(}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ inputs,}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ position\_ids,}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ attention\_mask,}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{None},}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{None},}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ images,}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ image\_sizes=image\_sizes}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \ \ \ \ inputs\_embeds\ =\ self.get\_model().embed\_tokens(inputs)}
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ super().generate(}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \ \ \ \ position\_ids=position\_ids,}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \ \ \ \ attention\_mask=attention\_mask,}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ \ \ \ \ inputs\_embeds=inputs\_embeds,}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \ \ \ \ **kwargs}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00216\ }

\end{DoxyCode}
Here is the call graph for this function\+:
% FIG 6
Here is the caller graph for this function\+:
% FIG 7
\Hypertarget{classllava__llama_1_1_llava_llama_for_causal_l_m_acb62d2eeebdce0deacfd0f86a86b4413}\index{llava\_llama.LlavaLlamaForCausalLM@{llava\_llama.LlavaLlamaForCausalLM}!get\_model@{get\_model}}
\index{get\_model@{get\_model}!llava\_llama.LlavaLlamaForCausalLM@{llava\_llama.LlavaLlamaForCausalLM}}
\doxysubsubsection{\texorpdfstring{get\_model()}{get\_model()}}
{\footnotesize\ttfamily \label{classllava__llama_1_1_llava_llama_for_causal_l_m_acb62d2eeebdce0deacfd0f86a86b4413} 
llava\+\_\+llama.\+Llava\+Llama\+For\+Causal\+LM.\+get\+\_\+model (\begin{DoxyParamCaption}\item[{}]{self}{}\end{DoxyParamCaption})}



모델 객체를 반환하는 메서드 

\begin{DoxyAuthor}{Author}
이지희(2021113406)
\end{DoxyAuthor}
\begin{DoxyReturn}{Returns}
LLa\+MA 모델 객체 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{llava__llama_8py_source_l00075}{75}} of file \mbox{\hyperlink{llava__llama_8py_source}{llava\+\_\+llama.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{keyword}{def\ }get\_model(self):}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.model}
\DoxyCodeLine{00077\ }

\end{DoxyCode}
Here is the caller graph for this function\+:
% FIG 8
\Hypertarget{classllava__llama_1_1_llava_llama_for_causal_l_m_a0f5cfb63f7c65b6a7b4a60c8399edbbb}\index{llava\_llama.LlavaLlamaForCausalLM@{llava\_llama.LlavaLlamaForCausalLM}!prepare\_inputs\_for\_generation@{prepare\_inputs\_for\_generation}}
\index{prepare\_inputs\_for\_generation@{prepare\_inputs\_for\_generation}!llava\_llama.LlavaLlamaForCausalLM@{llava\_llama.LlavaLlamaForCausalLM}}
\doxysubsubsection{\texorpdfstring{prepare\_inputs\_for\_generation()}{prepare\_inputs\_for\_generation()}}
{\footnotesize\ttfamily \label{classllava__llama_1_1_llava_llama_for_causal_l_m_a0f5cfb63f7c65b6a7b4a60c8399edbbb} 
llava\+\_\+llama.\+Llava\+Llama\+For\+Causal\+LM.\+prepare\+\_\+inputs\+\_\+for\+\_\+generation (\begin{DoxyParamCaption}\item[{}]{self}{, }\item[{}]{input\+\_\+ids}{, }\item[{}]{past\+\_\+key\+\_\+values}{ = {\ttfamily None}, }\item[{}]{inputs\+\_\+embeds}{ = {\ttfamily None}, }\item[{\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{kwargs}{}\end{DoxyParamCaption})}



생성에 필요한 입력을 준비하는 메서드 

\begin{DoxyAuthor}{Author}
이지희(2021113406)
\end{DoxyAuthor}
멀티모달 입력 데이터(텍스트와 이미지)를 준비하여 모델이 텍스트 생성 작업을 수행할 수 있도록 설정합니다. 텍스트 입력과 이미지 입력을 결합하여 필요한 형태로 반환합니다.


\begin{DoxyParams}{Parameters}
{\em input\+\_\+ids} & (torch.\+Long\+Tensor) 입력 텍스트 토큰 ID \\
\hline
{\em past\+\_\+key\+\_\+values} & (List\mbox{[}torch.\+Float\+Tensor\mbox{]}) 이전 키/값 캐시. 디코더에서 사용 (optional) \\
\hline
{\em inputs\+\_\+embeds} & (torch.\+Float\+Tensor) 입력 텍스트의 임베딩 (optional) \\
\hline
{\em \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}kwargs} & 추가 매개변수. 모델 입력에 필요한 이미지와 이미지 크기 데이터를 포함\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\begin{DoxyItemize}
\item dict\+: 준비된 입력 데이터 딕셔너리
\item 포함 항목\+:
\begin{DoxyItemize}
\item {\ttfamily input\+\_\+ids}\+: 입력 텍스트 토큰 ID
\item {\ttfamily past\+\_\+key\+\_\+values}\+: 이전 키/값 캐시
\item {\ttfamily inputs\+\_\+embeds}\+: 텍스트 임베딩
\item {\ttfamily images}\+: 입력 이미지 데이터 (제공된 경우)
\item {\ttfamily image\+\_\+sizes}\+: 이미지 크기 데이터 (제공된 경우)
\end{DoxyItemize}
\end{DoxyItemize}
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
super().\doxylink{classllava__llama_1_1_llava_llama_for_causal_l_m_a0f5cfb63f7c65b6a7b4a60c8399edbbb}{prepare\+\_\+inputs\+\_\+for\+\_\+generation}\+: 부모 클래스에서 제공하는 기본 입력 준비 메서드 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{llava__llama_8py_source_l00240}{240}} of file \mbox{\hyperlink{llava__llama_8py_source}{llava\+\_\+llama.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ inputs\_embeds=\textcolor{keywordtype}{None},\ **kwargs):}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ images\ =\ kwargs.pop(\textcolor{stringliteral}{"{}images"{}},\ \textcolor{keywordtype}{None})}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ image\_sizes\ =\ kwargs.pop(\textcolor{stringliteral}{"{}image\_sizes"{}},\ \textcolor{keywordtype}{None})}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ inputs\ =\ super().prepare\_inputs\_for\_generation(}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \ \ input\_ids,\ past\_key\_values=past\_key\_values,\ inputs\_embeds=inputs\_embeds,\ **kwargs}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ images\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ inputs[\textcolor{stringliteral}{'images'}]\ =\ images}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ image\_sizes\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \ \ inputs[\textcolor{stringliteral}{'image\_sizes'}]\ =\ image\_sizes}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ inputs}
\DoxyCodeLine{00252\ }

\end{DoxyCode}
Here is the call graph for this function\+:
% FIG 9
Here is the caller graph for this function\+:
% FIG 10


\doxysubsection{Member Data Documentation}
\Hypertarget{classllava__llama_1_1_llava_llama_for_causal_l_m_a5194779b4bddbbcd120b2e7b5273d6db}\index{llava\_llama.LlavaLlamaForCausalLM@{llava\_llama.LlavaLlamaForCausalLM}!config\_class@{config\_class}}
\index{config\_class@{config\_class}!llava\_llama.LlavaLlamaForCausalLM@{llava\_llama.LlavaLlamaForCausalLM}}
\doxysubsubsection{\texorpdfstring{config\_class}{config\_class}}
{\footnotesize\ttfamily \label{classllava__llama_1_1_llava_llama_for_causal_l_m_a5194779b4bddbbcd120b2e7b5273d6db} 
llava\+\_\+llama.\+Llava\+Llama\+For\+Causal\+LM.\+config\+\_\+class = \mbox{\hyperlink{classllava__llama_1_1_llava_config}{Llava\+Config}}\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \mbox{\hyperlink{llava__llama_8py_source_l00058}{58}} of file \mbox{\hyperlink{llava__llama_8py_source}{llava\+\_\+llama.\+py}}.

\Hypertarget{classllava__llama_1_1_llava_llama_for_causal_l_m_ae9922983d9c91d3f186e759de4d400c1}\index{llava\_llama.LlavaLlamaForCausalLM@{llava\_llama.LlavaLlamaForCausalLM}!lm\_head@{lm\_head}}
\index{lm\_head@{lm\_head}!llava\_llama.LlavaLlamaForCausalLM@{llava\_llama.LlavaLlamaForCausalLM}}
\doxysubsubsection{\texorpdfstring{lm\_head}{lm\_head}}
{\footnotesize\ttfamily \label{classllava__llama_1_1_llava_llama_for_causal_l_m_ae9922983d9c91d3f186e759de4d400c1} 
llava\+\_\+llama.\+Llava\+Llama\+For\+Causal\+LM.\+lm\+\_\+head = nn.\+Linear(config.\+hidden\+\_\+size, config.\+vocab\+\_\+size, bias=False)}



Definition at line \mbox{\hyperlink{llava__llama_8py_source_l00065}{65}} of file \mbox{\hyperlink{llava__llama_8py_source}{llava\+\_\+llama.\+py}}.

\Hypertarget{classllava__llama_1_1_llava_llama_for_causal_l_m_a5a8752f2f58a4a3a806a69eb2ffaf118}\index{llava\_llama.LlavaLlamaForCausalLM@{llava\_llama.LlavaLlamaForCausalLM}!model@{model}}
\index{model@{model}!llava\_llama.LlavaLlamaForCausalLM@{llava\_llama.LlavaLlamaForCausalLM}}
\doxysubsubsection{\texorpdfstring{model}{model}}
{\footnotesize\ttfamily \label{classllava__llama_1_1_llava_llama_for_causal_l_m_a5a8752f2f58a4a3a806a69eb2ffaf118} 
llava\+\_\+llama.\+Llava\+Llama\+For\+Causal\+LM.\+model = \mbox{\hyperlink{classllava__llama_1_1_llava_llama_model}{Llava\+Llama\+Model}}(config)}



Definition at line \mbox{\hyperlink{llava__llama_8py_source_l00062}{62}} of file \mbox{\hyperlink{llava__llama_8py_source}{llava\+\_\+llama.\+py}}.

\Hypertarget{classllava__llama_1_1_llava_llama_for_causal_l_m_a401f8203732fb6a2270425993ddc7caa}\index{llava\_llama.LlavaLlamaForCausalLM@{llava\_llama.LlavaLlamaForCausalLM}!pretraining\_tp@{pretraining\_tp}}
\index{pretraining\_tp@{pretraining\_tp}!llava\_llama.LlavaLlamaForCausalLM@{llava\_llama.LlavaLlamaForCausalLM}}
\doxysubsubsection{\texorpdfstring{pretraining\_tp}{pretraining\_tp}}
{\footnotesize\ttfamily \label{classllava__llama_1_1_llava_llama_for_causal_l_m_a401f8203732fb6a2270425993ddc7caa} 
llava\+\_\+llama.\+Llava\+Llama\+For\+Causal\+LM.\+pretraining\+\_\+tp = config.\+pretraining\+\_\+tp}



Definition at line \mbox{\hyperlink{llava__llama_8py_source_l00063}{63}} of file \mbox{\hyperlink{llava__llama_8py_source}{llava\+\_\+llama.\+py}}.

\Hypertarget{classllava__llama_1_1_llava_llama_for_causal_l_m_a83d0e6aa1cdf2893381d825300078370}\index{llava\_llama.LlavaLlamaForCausalLM@{llava\_llama.LlavaLlamaForCausalLM}!vocab\_size@{vocab\_size}}
\index{vocab\_size@{vocab\_size}!llava\_llama.LlavaLlamaForCausalLM@{llava\_llama.LlavaLlamaForCausalLM}}
\doxysubsubsection{\texorpdfstring{vocab\_size}{vocab\_size}}
{\footnotesize\ttfamily \label{classllava__llama_1_1_llava_llama_for_causal_l_m_a83d0e6aa1cdf2893381d825300078370} 
llava\+\_\+llama.\+Llava\+Llama\+For\+Causal\+LM.\+vocab\+\_\+size = config.\+vocab\+\_\+size}



Definition at line \mbox{\hyperlink{llava__llama_8py_source_l00064}{64}} of file \mbox{\hyperlink{llava__llama_8py_source}{llava\+\_\+llama.\+py}}.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
language\+\_\+model/\mbox{\hyperlink{llava__llama_8py}{llava\+\_\+llama.\+py}}\end{DoxyCompactItemize}
