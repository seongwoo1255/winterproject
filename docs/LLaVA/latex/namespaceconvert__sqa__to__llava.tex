\doxysection{convert\+\_\+sqa\+\_\+to\+\_\+llava Namespace Reference}
\hypertarget{namespaceconvert__sqa__to__llava}{}\label{namespaceconvert__sqa__to__llava}\index{convert\_sqa\_to\_llava@{convert\_sqa\_to\_llava}}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespaceconvert__sqa__to__llava_af20ded7c6cc6cda151eed7eccce9403c}{convert\+\_\+to\+\_\+llava}} (base\+\_\+dir, split, prompt\+\_\+format="{}QCM-\/LEA"{})
\item 
\mbox{\hyperlink{namespaceconvert__sqa__to__llava_a43c1c6ba3a480d1336d09ac0b40a0e3e}{convert\+\_\+to\+\_\+jsonl}} (base\+\_\+dir, split, prompt\+\_\+format="{}QCM-\/LEPA"{})
\item 
\mbox{\hyperlink{namespaceconvert__sqa__to__llava_ab4b1383307c55f2dc07753e0e8fdf128}{main}} (task, \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}kwargs)
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\Hypertarget{namespaceconvert__sqa__to__llava_a43c1c6ba3a480d1336d09ac0b40a0e3e}\index{convert\_sqa\_to\_llava@{convert\_sqa\_to\_llava}!convert\_to\_jsonl@{convert\_to\_jsonl}}
\index{convert\_to\_jsonl@{convert\_to\_jsonl}!convert\_sqa\_to\_llava@{convert\_sqa\_to\_llava}}
\doxysubsubsection{\texorpdfstring{convert\_to\_jsonl()}{convert\_to\_jsonl()}}
{\footnotesize\ttfamily \label{namespaceconvert__sqa__to__llava_a43c1c6ba3a480d1336d09ac0b40a0e3e} 
convert\+\_\+sqa\+\_\+to\+\_\+llava.\+convert\+\_\+to\+\_\+jsonl (\begin{DoxyParamCaption}\item[{}]{base\+\_\+dir}{, }\item[{}]{split}{, }\item[{}]{prompt\+\_\+format}{ = {\ttfamily "{}QCM-\/LEPA"{}}}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{convert__sqa__to__llava_8py_source_l00049}{49}} of file \mbox{\hyperlink{convert__sqa__to__llava_8py_source}{convert\+\_\+sqa\+\_\+to\+\_\+llava.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00049\ \textcolor{keyword}{def\ }convert\_to\_jsonl(base\_dir,\ split,\ prompt\_format="{}QCM-\/LEPA"{}):}
\DoxyCodeLine{00050\ \ \ \ \ split\_indices\ =\ json.load(open(os.path.join(base\_dir,\ \textcolor{stringliteral}{"{}pid\_splits.json"{}})))[split]}
\DoxyCodeLine{00051\ \ \ \ \ problems\ =\ json.load(open(os.path.join(base\_dir,\ \textcolor{stringliteral}{"{}problems.json"{}})))}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \ \ \ \ split\_problems\ =\ build\_prompt\_chatbot(}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ problems,\ split\_indices,\ prompt\_format,}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ use\_caption=\textcolor{keyword}{False},\ is\_test=\textcolor{keyword}{False})}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \ \ \ \ writer\ =\ open(os.path.join(base\_dir,\ f\textcolor{stringliteral}{"{}scienceqa\_\{split\}\_\{prompt\_format\}.jsonl"{}}),\ \textcolor{stringliteral}{"{}w"{}})}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keywordflow}{for}\ prob\_id,\ (input,\ output)\ \textcolor{keywordflow}{in}\ split\_problems.items():}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ input.startswith(\textcolor{stringliteral}{'Question:\ '}):}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \ \ \ \ input\ =\ input.replace(\textcolor{stringliteral}{'Question:\ '},\ \textcolor{stringliteral}{''})}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ output.startswith(\textcolor{stringliteral}{'Answer:\ '}):}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ output\ =\ output.replace(\textcolor{stringliteral}{'Answer:\ '},\ \textcolor{stringliteral}{''})}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ raw\_prob\_data\ =\ problems[prob\_id]}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ raw\_prob\_data[\textcolor{stringliteral}{'image'}]\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \ \ data\ =\ \{}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}id"{}}:\ prob\_id,}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}instruction"{}}:\ f\textcolor{stringliteral}{"{}\{input\}"{}},}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}output"{}}:\ f\textcolor{stringliteral}{"{}\{output\}"{}},}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \ \ data\ =\ \{}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}id"{}}:\ prob\_id,}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}image"{}}:\ os.path.join(prob\_id,\ raw\_prob\_data[\textcolor{stringliteral}{'image'}]),}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}instruction"{}}:\ f\textcolor{stringliteral}{"{}\{input\}\(\backslash\)n<image>"{}},}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}output"{}}:\ f\textcolor{stringliteral}{"{}\{output\}"{}},}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ writer.write(json.dumps(data)\ +\ \textcolor{stringliteral}{'\(\backslash\)n'})}
\DoxyCodeLine{00080\ \ \ \ \ writer.close()}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ }

\end{DoxyCode}
\Hypertarget{namespaceconvert__sqa__to__llava_af20ded7c6cc6cda151eed7eccce9403c}\index{convert\_sqa\_to\_llava@{convert\_sqa\_to\_llava}!convert\_to\_llava@{convert\_to\_llava}}
\index{convert\_to\_llava@{convert\_to\_llava}!convert\_sqa\_to\_llava@{convert\_sqa\_to\_llava}}
\doxysubsubsection{\texorpdfstring{convert\_to\_llava()}{convert\_to\_llava()}}
{\footnotesize\ttfamily \label{namespaceconvert__sqa__to__llava_af20ded7c6cc6cda151eed7eccce9403c} 
convert\+\_\+sqa\+\_\+to\+\_\+llava.\+convert\+\_\+to\+\_\+llava (\begin{DoxyParamCaption}\item[{}]{base\+\_\+dir}{, }\item[{}]{split}{, }\item[{}]{prompt\+\_\+format}{ = {\ttfamily "{}QCM-\/LEA"{}}}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{convert__sqa__to__llava_8py_source_l00008}{8}} of file \mbox{\hyperlink{convert__sqa__to__llava_8py_source}{convert\+\_\+sqa\+\_\+to\+\_\+llava.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00008\ \textcolor{keyword}{def\ }convert\_to\_llava(base\_dir,\ split,\ prompt\_format="{}QCM-\/LEA"{}):}
\DoxyCodeLine{00009\ \ \ \ \ split\_indices\ =\ json.load(open(os.path.join(base\_dir,\ \textcolor{stringliteral}{"{}pid\_splits.json"{}})))[split]}
\DoxyCodeLine{00010\ \ \ \ \ problems\ =\ json.load(open(os.path.join(base\_dir,\ \textcolor{stringliteral}{"{}problems.json"{}})))}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \ \ \ \ split\_problems\ =\ build\_prompt\_chatbot(}
\DoxyCodeLine{00013\ \ \ \ \ \ \ \ \ problems,\ split\_indices,\ prompt\_format,}
\DoxyCodeLine{00014\ \ \ \ \ \ \ \ \ use\_caption=\textcolor{keyword}{False},\ is\_test=\textcolor{keyword}{False})}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \ \ \ \ target\_format\ =\ []}
\DoxyCodeLine{00017\ \ \ \ \ \textcolor{keywordflow}{for}\ prob\_id,\ (input,\ output)\ \textcolor{keywordflow}{in}\ split\_problems.items():}
\DoxyCodeLine{00018\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ input.startswith(\textcolor{stringliteral}{'Question:\ '}):}
\DoxyCodeLine{00019\ \ \ \ \ \ \ \ \ \ \ \ \ input\ =\ input.replace(\textcolor{stringliteral}{'Question:\ '},\ \textcolor{stringliteral}{''})}
\DoxyCodeLine{00020\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ output.startswith(\textcolor{stringliteral}{'Answer:\ '}):}
\DoxyCodeLine{00021\ \ \ \ \ \ \ \ \ \ \ \ \ output\ =\ output.replace(\textcolor{stringliteral}{'Answer:\ '},\ \textcolor{stringliteral}{''})}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ raw\_prob\_data\ =\ problems[prob\_id]}
\DoxyCodeLine{00024\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ raw\_prob\_data[\textcolor{stringliteral}{'image'}]\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{00025\ \ \ \ \ \ \ \ \ \ \ \ \ target\_format.append(\{}
\DoxyCodeLine{00026\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}id"{}}:\ prob\_id,}
\DoxyCodeLine{00027\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}conversations"{}}:\ [}
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{'from'}:\ \textcolor{stringliteral}{'human'},\ \textcolor{stringliteral}{'value'}:\ f\textcolor{stringliteral}{"{}\{input\}"{}}\},}
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{'from'}:\ \textcolor{stringliteral}{'gpt'},\ \textcolor{stringliteral}{'value'}:\ f\textcolor{stringliteral}{"{}\{output\}"{}}\},}
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ],}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \ \ \ \ \})}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \ \ \ \ target\_format.append(\{}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}id"{}}:\ prob\_id,}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}image"{}}:\ os.path.join(prob\_id,\ raw\_prob\_data[\textcolor{stringliteral}{'image'}]),}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}conversations"{}}:\ [}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{'from'}:\ \textcolor{stringliteral}{'human'},\ \textcolor{stringliteral}{'value'}:\ f\textcolor{stringliteral}{"{}\{input\}\(\backslash\)n<image>"{}}\},}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{'from'}:\ \textcolor{stringliteral}{'gpt'},\ \textcolor{stringliteral}{'value'}:\ f\textcolor{stringliteral}{"{}\{output\}"{}}\},}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ],}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \ \ \ \ \})}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \ \ \ \ print(f\textcolor{stringliteral}{'Number\ of\ samples:\ \{len(target\_format)\}'})}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{keyword}{with}\ open(os.path.join(base\_dir,\ f\textcolor{stringliteral}{"{}llava\_\{split\}\_\{prompt\_format\}.json"{}}),\ \textcolor{stringliteral}{"{}w"{}})\ \textcolor{keyword}{as}\ f:}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ json.dump(target\_format,\ f,\ indent=2)}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ }

\end{DoxyCode}
\Hypertarget{namespaceconvert__sqa__to__llava_ab4b1383307c55f2dc07753e0e8fdf128}\index{convert\_sqa\_to\_llava@{convert\_sqa\_to\_llava}!main@{main}}
\index{main@{main}!convert\_sqa\_to\_llava@{convert\_sqa\_to\_llava}}
\doxysubsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily \label{namespaceconvert__sqa__to__llava_ab4b1383307c55f2dc07753e0e8fdf128} 
convert\+\_\+sqa\+\_\+to\+\_\+llava.\+main (\begin{DoxyParamCaption}\item[{}]{task}{, }\item[{\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{kwargs}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{convert__sqa__to__llava_8py_source_l00083}{83}} of file \mbox{\hyperlink{convert__sqa__to__llava_8py_source}{convert\+\_\+sqa\+\_\+to\+\_\+llava.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00083\ \textcolor{keyword}{def\ }main(task,\ **kwargs):}
\DoxyCodeLine{00084\ \ \ \ \ globals()[task](**kwargs)}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ }

\end{DoxyCode}
