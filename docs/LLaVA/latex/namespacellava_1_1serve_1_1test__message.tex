\doxysection{llava.\+serve.\+test\+\_\+message Namespace Reference}
\hypertarget{namespacellava_1_1serve_1_1test__message}{}\label{namespacellava_1_1serve_1_1test__message}\index{llava.serve.test\_message@{llava.serve.test\_message}}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacellava_1_1serve_1_1test__message_aa740d5f5f456693d682d92dd5977bc22}{main}} ()
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacellava_1_1serve_1_1test__message_a226165bd0f3dcac41b6e88152671c51f}{parser}} = argparse.\+Argument\+Parser()
\item 
\mbox{\hyperlink{namespacellava_1_1serve_1_1test__message_a86d10810f1de0d3b47edf112b1fc67a1}{type}}
\item 
\mbox{\hyperlink{namespacellava_1_1serve_1_1test__message_ad694f09bad1a553ae9f922d000675306}{str}}
\item 
\mbox{\hyperlink{namespacellava_1_1serve_1_1test__message_a89a8d1fa664f440ad6de3be685ee30e2}{default}}
\item 
\mbox{\hyperlink{namespacellava_1_1serve_1_1test__message_a52aa8103c117a77f7fd84f85582f6040}{int}}
\item 
\mbox{\hyperlink{namespacellava_1_1serve_1_1test__message_a8a66ece972d8728be4f5ac996dc19c40}{args}} = parser.\+parse\+\_\+args()
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\Hypertarget{namespacellava_1_1serve_1_1test__message_aa740d5f5f456693d682d92dd5977bc22}\index{llava.serve.test\_message@{llava.serve.test\_message}!main@{main}}
\index{main@{main}!llava.serve.test\_message@{llava.serve.test\_message}}
\doxysubsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily \label{namespacellava_1_1serve_1_1test__message_aa740d5f5f456693d682d92dd5977bc22} 
llava.\+serve.\+test\+\_\+message.\+main (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{test__message_8py_source_l00009}{9}} of file \mbox{\hyperlink{test__message_8py_source}{test\+\_\+message.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00009\ \textcolor{keyword}{def\ }main():}
\DoxyCodeLine{00010\ \ \ \ \ \textcolor{keywordflow}{if}\ args.worker\_address:}
\DoxyCodeLine{00011\ \ \ \ \ \ \ \ \ worker\_addr\ =\ args.worker\_address}
\DoxyCodeLine{00012\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{00013\ \ \ \ \ \ \ \ \ controller\_addr\ =\ args.controller\_address}
\DoxyCodeLine{00014\ \ \ \ \ \ \ \ \ ret\ =\ requests.post(controller\_addr\ +\ \textcolor{stringliteral}{"{}/refresh\_all\_workers"{}})}
\DoxyCodeLine{00015\ \ \ \ \ \ \ \ \ ret\ =\ requests.post(controller\_addr\ +\ \textcolor{stringliteral}{"{}/list\_models"{}})}
\DoxyCodeLine{00016\ \ \ \ \ \ \ \ \ models\ =\ ret.json()[\textcolor{stringliteral}{"{}models"{}}]}
\DoxyCodeLine{00017\ \ \ \ \ \ \ \ \ models.sort()}
\DoxyCodeLine{00018\ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}Models:\ \{models\}"{}})}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \ \ \ \ \ \ \ \ ret\ =\ requests.post(controller\_addr\ +\ \textcolor{stringliteral}{"{}/get\_worker\_address"{}},}
\DoxyCodeLine{00021\ \ \ \ \ \ \ \ \ \ \ \ \ json=\{\textcolor{stringliteral}{"{}model"{}}:\ args.model\_name\})}
\DoxyCodeLine{00022\ \ \ \ \ \ \ \ \ worker\_addr\ =\ ret.json()[\textcolor{stringliteral}{"{}address"{}}]}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}worker\_addr:\ \{worker\_addr\}"{}})}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \ \ \ \ \textcolor{keywordflow}{if}\ worker\_addr\ ==\ \textcolor{stringliteral}{"{}"{}}:}
\DoxyCodeLine{00026\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \ \ \ \ conv\ =\ default\_conversation.copy()}
\DoxyCodeLine{00029\ \ \ \ \ conv.append\_message(conv.roles[0],\ args.message)}
\DoxyCodeLine{00030\ \ \ \ \ prompt\ =\ conv.get\_prompt()}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \ \ \ \ headers\ =\ \{\textcolor{stringliteral}{"{}User-\/Agent"{}}:\ \textcolor{stringliteral}{"{}LLaVA\ Client"{}}\}}
\DoxyCodeLine{00033\ \ \ \ \ pload\ =\ \{}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}model"{}}:\ args.model\_name,}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}prompt"{}}:\ prompt,}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}max\_new\_tokens"{}}:\ args.max\_new\_tokens,}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}temperature"{}}:\ 0.7,}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}stop"{}}:\ conv.sep,}
\DoxyCodeLine{00039\ \ \ \ \ \}}
\DoxyCodeLine{00040\ \ \ \ \ response\ =\ requests.post(worker\_addr\ +\ \textcolor{stringliteral}{"{}/worker\_generate\_stream"{}},\ headers=headers,}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \ \ \ \ json=pload,\ stream=\textcolor{keyword}{True})}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \ \ \ \ print(prompt.replace(conv.sep,\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}),\ end=\textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keywordflow}{for}\ chunk\ \textcolor{keywordflow}{in}\ response.iter\_lines(chunk\_size=8192,\ decode\_unicode=\textcolor{keyword}{False},\ delimiter=b\textcolor{stringliteral}{"{}\(\backslash\)0"{}}):}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ chunk:}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \ \ \ \ data\ =\ json.loads(chunk.decode(\textcolor{stringliteral}{"{}utf-\/8"{}}))}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \ \ \ \ output\ =\ data[\textcolor{stringliteral}{"{}text"{}}].split(conv.sep)[-\/1]}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \ \ \ \ print(output,\ end=\textcolor{stringliteral}{"{}\(\backslash\)r"{}})}
\DoxyCodeLine{00049\ \ \ \ \ print(\textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ }

\end{DoxyCode}


\doxysubsection{Variable Documentation}
\Hypertarget{namespacellava_1_1serve_1_1test__message_a8a66ece972d8728be4f5ac996dc19c40}\index{llava.serve.test\_message@{llava.serve.test\_message}!args@{args}}
\index{args@{args}!llava.serve.test\_message@{llava.serve.test\_message}}
\doxysubsubsection{\texorpdfstring{args}{args}}
{\footnotesize\ttfamily \label{namespacellava_1_1serve_1_1test__message_a8a66ece972d8728be4f5ac996dc19c40} 
llava.\+serve.\+test\+\_\+message.\+args = parser.\+parse\+\_\+args()}



Definition at line \mbox{\hyperlink{test__message_8py_source_l00060}{60}} of file \mbox{\hyperlink{test__message_8py_source}{test\+\_\+message.\+py}}.

\Hypertarget{namespacellava_1_1serve_1_1test__message_a89a8d1fa664f440ad6de3be685ee30e2}\index{llava.serve.test\_message@{llava.serve.test\_message}!default@{default}}
\index{default@{default}!llava.serve.test\_message@{llava.serve.test\_message}}
\doxysubsubsection{\texorpdfstring{default}{default}}
{\footnotesize\ttfamily \label{namespacellava_1_1serve_1_1test__message_a89a8d1fa664f440ad6de3be685ee30e2} 
llava.\+serve.\+test\+\_\+message.\+default}



Definition at line \mbox{\hyperlink{test__message_8py_source_l00054}{54}} of file \mbox{\hyperlink{test__message_8py_source}{test\+\_\+message.\+py}}.

\Hypertarget{namespacellava_1_1serve_1_1test__message_a52aa8103c117a77f7fd84f85582f6040}\index{llava.serve.test\_message@{llava.serve.test\_message}!int@{int}}
\index{int@{int}!llava.serve.test\_message@{llava.serve.test\_message}}
\doxysubsubsection{\texorpdfstring{int}{int}}
{\footnotesize\ttfamily \label{namespacellava_1_1serve_1_1test__message_a52aa8103c117a77f7fd84f85582f6040} 
llava.\+serve.\+test\+\_\+message.\+int}



Definition at line \mbox{\hyperlink{test__message_8py_source_l00057}{57}} of file \mbox{\hyperlink{test__message_8py_source}{test\+\_\+message.\+py}}.

\Hypertarget{namespacellava_1_1serve_1_1test__message_a226165bd0f3dcac41b6e88152671c51f}\index{llava.serve.test\_message@{llava.serve.test\_message}!parser@{parser}}
\index{parser@{parser}!llava.serve.test\_message@{llava.serve.test\_message}}
\doxysubsubsection{\texorpdfstring{parser}{parser}}
{\footnotesize\ttfamily \label{namespacellava_1_1serve_1_1test__message_a226165bd0f3dcac41b6e88152671c51f} 
llava.\+serve.\+test\+\_\+message.\+parser = argparse.\+Argument\+Parser()}



Definition at line \mbox{\hyperlink{test__message_8py_source_l00053}{53}} of file \mbox{\hyperlink{test__message_8py_source}{test\+\_\+message.\+py}}.

\Hypertarget{namespacellava_1_1serve_1_1test__message_ad694f09bad1a553ae9f922d000675306}\index{llava.serve.test\_message@{llava.serve.test\_message}!str@{str}}
\index{str@{str}!llava.serve.test\_message@{llava.serve.test\_message}}
\doxysubsubsection{\texorpdfstring{str}{str}}
{\footnotesize\ttfamily \label{namespacellava_1_1serve_1_1test__message_ad694f09bad1a553ae9f922d000675306} 
llava.\+serve.\+test\+\_\+message.\+str}



Definition at line \mbox{\hyperlink{test__message_8py_source_l00054}{54}} of file \mbox{\hyperlink{test__message_8py_source}{test\+\_\+message.\+py}}.

\Hypertarget{namespacellava_1_1serve_1_1test__message_a86d10810f1de0d3b47edf112b1fc67a1}\index{llava.serve.test\_message@{llava.serve.test\_message}!type@{type}}
\index{type@{type}!llava.serve.test\_message@{llava.serve.test\_message}}
\doxysubsubsection{\texorpdfstring{type}{type}}
{\footnotesize\ttfamily \label{namespacellava_1_1serve_1_1test__message_a86d10810f1de0d3b47edf112b1fc67a1} 
llava.\+serve.\+test\+\_\+message.\+type}



Definition at line \mbox{\hyperlink{test__message_8py_source_l00054}{54}} of file \mbox{\hyperlink{test__message_8py_source}{test\+\_\+message.\+py}}.

