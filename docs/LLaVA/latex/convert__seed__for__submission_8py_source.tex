\doxysection{convert\+\_\+seed\+\_\+for\+\_\+submission.\+py}
\hypertarget{convert__seed__for__submission_8py_source}{}\label{convert__seed__for__submission_8py_source}\index{scripts/convert\_seed\_for\_submission.py@{scripts/convert\_seed\_for\_submission.py}}
\mbox{\hyperlink{convert__seed__for__submission_8py}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00001}\mbox{\hyperlink{namespaceconvert__seed__for__submission}{00001}}\ \textcolor{keyword}{import}\ os}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00002}00002\ \textcolor{keyword}{import}\ json}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00003}00003\ \textcolor{keyword}{import}\ argparse}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00005}00005\ }
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00006}\mbox{\hyperlink{namespaceconvert__seed__for__submission_a8c1f79fa1f7413c2bb874d6fe3946c67}{00006}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespaceconvert__seed__for__submission_a8c1f79fa1f7413c2bb874d6fe3946c67}{get\_args}}():}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00007}00007\ \ \ \ \ parser\ =\ argparse.ArgumentParser()}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00008}00008\ \ \ \ \ parser.add\_argument(\textcolor{stringliteral}{"{}-\/-\/annotation-\/file"{}},\ type=str)}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00009}00009\ \ \ \ \ parser.add\_argument(\textcolor{stringliteral}{"{}-\/-\/result-\/file"{}},\ type=str)}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00010}00010\ \ \ \ \ parser.add\_argument(\textcolor{stringliteral}{"{}-\/-\/result-\/upload-\/file"{}},\ type=str)}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00011}00011\ \ \ \ \ \textcolor{keywordflow}{return}\ parser.parse\_args()}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00013}00013\ }
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00014}\mbox{\hyperlink{namespaceconvert__seed__for__submission_a74e0b3a9ff4244319fce97dc114b4e94}{00014}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespaceconvert__seed__for__submission_a74e0b3a9ff4244319fce97dc114b4e94}{eval\_single}}(result\_file,\ eval\_only\_type=None):}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00015}00015\ \ \ \ \ results\ =\ \{\}}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00016}00016\ \ \ \ \ \textcolor{keywordflow}{for}\ line\ \textcolor{keywordflow}{in}\ open(result\_file):}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00017}00017\ \ \ \ \ \ \ \ \ row\ =\ json.loads(line)}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00018}00018\ \ \ \ \ \ \ \ \ results[row[\textcolor{stringliteral}{'question\_id'}]]\ =\ row}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00019}00019\ }
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00020}00020\ \ \ \ \ type\_counts\ =\ \{\}}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00021}00021\ \ \ \ \ correct\_counts\ =\ \{\}}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00022}00022\ \ \ \ \ \textcolor{keywordflow}{for}\ question\_data\ \textcolor{keywordflow}{in}\ data[\textcolor{stringliteral}{'questions'}]:}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00023}00023\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ eval\_only\_type\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{and}\ question\_data[\textcolor{stringliteral}{'data\_type'}]\ !=\ eval\_only\_type:\ \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00024}00024\ \ \ \ \ \ \ \ \ data\_type\ =\ question\_data[\textcolor{stringliteral}{'question\_type\_id'}]}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00025}00025\ \ \ \ \ \ \ \ \ type\_counts[data\_type]\ =\ type\_counts.get(data\_type,\ 0)\ +\ 1}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00026}00026\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00027}00027\ \ \ \ \ \ \ \ \ \ \ \ \ question\_id\ =\ int(question\_data[\textcolor{stringliteral}{'question\_id'}])}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00028}00028\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}:}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00029}00029\ \ \ \ \ \ \ \ \ \ \ \ \ question\_id\ =\ question\_data[\textcolor{stringliteral}{'question\_id'}]}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00030}00030\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ question\_id\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ results:}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00031}00031\ \ \ \ \ \ \ \ \ \ \ \ \ correct\_counts[data\_type]\ =\ correct\_counts.get(data\_type,\ 0)}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00032}00032\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00033}00033\ \ \ \ \ \ \ \ \ row\ =\ results[question\_id]}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00034}00034\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ row[\textcolor{stringliteral}{'text'}]\ ==\ question\_data[\textcolor{stringliteral}{'answer'}]:}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00035}00035\ \ \ \ \ \ \ \ \ \ \ \ \ correct\_counts[data\_type]\ =\ correct\_counts.get(data\_type,\ 0)\ +\ 1}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00036}00036\ }
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00037}00037\ \ \ \ \ total\_count\ =\ 0}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00038}00038\ \ \ \ \ total\_correct\ =\ 0}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00039}00039\ \ \ \ \ \textcolor{keywordflow}{for}\ data\_type\ \textcolor{keywordflow}{in}\ sorted(type\_counts.keys()):}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00040}00040\ \ \ \ \ \ \ \ \ accuracy\ =\ correct\_counts[data\_type]\ /\ type\_counts[data\_type]\ *\ 100}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00041}00041\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ eval\_only\_type\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00042}00042\ \ \ \ \ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}\{ques\_type\_id\_to\_name[data\_type]\}:\ \{accuracy:.2f\}\%"{}})}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00043}00043\ }
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00044}00044\ \ \ \ \ \ \ \ \ total\_count\ +=\ type\_counts[data\_type]}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00045}00045\ \ \ \ \ \ \ \ \ total\_correct\ +=\ correct\_counts[data\_type]}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00046}00046\ }
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00047}00047\ \ \ \ \ total\_accuracy\ =\ total\_correct\ /\ total\_count\ *\ 100}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00048}00048\ \ \ \ \ \textcolor{keywordflow}{if}\ eval\_only\_type\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00049}00049\ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}Total\ accuracy:\ \{total\_accuracy:.2f\}\%"{}})}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00050}00050\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00051}00051\ \ \ \ \ \ \ \ \ print(f\textcolor{stringliteral}{"{}\{eval\_only\_type\}\ accuracy:\ \{total\_accuracy:.2f\}\%"{}})}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00052}00052\ }
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00053}00053\ \ \ \ \ \textcolor{keywordflow}{return}\ results}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00054}00054\ }
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00055}00055\ \textcolor{keywordflow}{if}\ \_\_name\_\_\ ==\ \textcolor{stringliteral}{"{}\_\_main\_\_"{}}:}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00056}\mbox{\hyperlink{namespaceconvert__seed__for__submission_a79cee289b24af44351d18021ae10425a}{00056}}\ \ \ \ \ args\ =\ \mbox{\hyperlink{namespaceconvert__seed__for__submission_a8c1f79fa1f7413c2bb874d6fe3946c67}{get\_args}}()}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00057}\mbox{\hyperlink{namespaceconvert__seed__for__submission_adba6f300aeafa133ef87bf2f02448954}{00057}}\ \ \ \ \ data\ =\ json.load(open(args.annotation\_file))}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00058}\mbox{\hyperlink{namespaceconvert__seed__for__submission_a0c9e5a70cc21c846c75d04e16f94cd92}{00058}}\ \ \ \ \ ques\_type\_id\_to\_name\ =\ \{id:n\ \textcolor{keywordflow}{for}\ n,id\ \textcolor{keywordflow}{in}\ data[\textcolor{stringliteral}{'question\_type'}].items()\}}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00059}00059\ }
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00060}\mbox{\hyperlink{namespaceconvert__seed__for__submission_adf54001b7213b277619faa21c28654d3}{00060}}\ \ \ \ \ results\ =\ \mbox{\hyperlink{namespaceconvert__seed__for__submission_a74e0b3a9ff4244319fce97dc114b4e94}{eval\_single}}(args.result\_file)}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00061}\mbox{\hyperlink{namespaceconvert__seed__for__submission_a8e491fb79e0e23d39fb8983e3de4d98d}{00061}}\ \ \ \ \ \mbox{\hyperlink{namespaceconvert__seed__for__submission_a74e0b3a9ff4244319fce97dc114b4e94}{eval\_single}}(args.result\_file,\ eval\_only\_type=\textcolor{stringliteral}{'image'})}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00062}00062\ \ \ \ \ \mbox{\hyperlink{namespaceconvert__seed__for__submission_a74e0b3a9ff4244319fce97dc114b4e94}{eval\_single}}(args.result\_file,\ eval\_only\_type=\textcolor{stringliteral}{'video'})}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00063}00063\ }
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00064}00064\ \ \ \ \ \textcolor{keyword}{with}\ open(args.result\_upload\_file,\ \textcolor{stringliteral}{'w'})\ \textcolor{keyword}{as}\ fp:}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00065}00065\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ question\ \textcolor{keywordflow}{in}\ data[\textcolor{stringliteral}{'questions'}]:}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00066}\mbox{\hyperlink{namespaceconvert__seed__for__submission_aab94ac698d419cded175a73e013d6d82}{00066}}\ \ \ \ \ \ \ \ \ \ \ \ \ qid\ =\ question[\textcolor{stringliteral}{'question\_id'}]}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00067}00067\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ qid\ \textcolor{keywordflow}{in}\ results:}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00068}\mbox{\hyperlink{namespaceconvert__seed__for__submission_a40af681d0ef8dca49a137eb7d08e18b8}{00068}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ result\ =\ results[qid]}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00069}00069\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00070}00070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ result\ =\ results[int(qid)]}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00071}00071\ \ \ \ \ \ \ \ \ \ \ \ \ fp.write(json.dumps(\{}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00072}00072\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'question\_id'}:\ qid,}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00073}00073\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'prediction'}:\ result[\textcolor{stringliteral}{'text'}]}
\DoxyCodeLine{\Hypertarget{convert__seed__for__submission_8py_source_l00074}00074\ \ \ \ \ \ \ \ \ \ \ \ \ \})\ +\ \textcolor{stringliteral}{'\(\backslash\)n'})}

\end{DoxyCode}
